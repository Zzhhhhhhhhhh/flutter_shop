webpackJsonp([23],{"4tRP":function(i,t){},l0kH:function(i,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=e("mvHQ"),s=e.n(n),a={data:function(){return{isflag:!1,frontAllSeat:void 0,formInline:{data:void 0,beginTimeH:"8",beginTimeS:"0",endTimeH:"10",endTimeS:"59"},allCount:0,host:"",show:"",sum:"76%",xdata:[],img:[{img:"../../../static/img/test.jpg",time:"2017-03-04 09:02:00"},{img:"../../../static/img/test.jpg",time:"2017-03-04 09:04:00"},{img:"../../../static/img/test.jpg",time:"2017-03-04 09:06:00"},{img:"../../../static/img/test.jpg",time:"2017-03-04 09:08:00"},{img:"../../../static/img/test.jpg",time:"2017-03-04 09:10:00"},{img:"../../../static/img/test.jpg",time:"2017-03-04 09:12:00"},{img:"../../../static/img/test.jpg",time:"2017-03-04 09:14:00"},{img:"../../../static/img/test.jpg",time:"2017-03-04 09:16:00"},{img:"../../../static/img/test.jpg",time:"2017-03-04 09:18:00"},{img:"../../../static/img/test.jpg",time:"2017-03-04 09:20:00"},{img:"../../../static/img/test.jpg",time:"2017-03-04 09:22:00"},{img:"../../../static/img/test.jpg",time:"2017-03-04 09:24:00"},{img:"../../../static/img/test.jpg",time:"2017-03-04 09:26:00"},{img:"../../../static/img/test.jpg",time:"2017-03-04 09:28:00"}],taitouY:[],chuqinY:[],listQuery:{data:void 0,beginTime:void 0,endtIME:void 0},listprop:{type:1,title:"学情分析统计"},dialogPic:!1,detailImgPath:"",listData:[],queryObj:{startTime:"",endTime:""}}},created:function(){window.detailClick=this.detailClick},mounted:function(){this.getNowTime()},methods:{drawLine:function(){var i=this;this.$echarts.init(document.getElementById("myChart")).setOption({title:{},tooltip:{trigger:"axis",show:!0,enterable:!0,position:function(i,t,e,n,s){var a=i[0],o=i[1],r=s.contentSize[0],m=s.contentSize[1];return[r>a?5:a-r,m>o?5:o-m]},axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},formatter:function(t){i.listData.forEach(function(e){if(e.DateTime.split(" ")[1]==t[0].axisValue){var n=e.SavePath.split("Camera/")[1].replace(/\//g,"/"),s=window.location.hostname;i.detailImgPath=window.location.protocol+"//"+s+":8000/"+n+"/"+e.SaveFileName}});i.img;for(var e=t[0].name,n=["#038eed","green"],s=0;s<t.length;s++)e+='<p><span style="background-color:'+n[s]+';display: inline-block;width:10px;height:10px;margin-right:5px;border-radius: 50%;"></span>'+t[s].seriesName+':<span style="padding-left:4px"></span>'+t[s].data+" </p>\n              ";return e+='<div style="text-align: center;color: #4C8FFD;cursor: pointer" onclick="detailClick()">查看所有详情</div>'}},legend:{data:["出勤人数","抬头人数"],width:100,right:30},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:this.xdata}],yAxis:[{type:"value",minInterval:1}],dataZoom:[{type:"inside",fillerColor:"rgba(167,183,204,0.4)"}],series:[{name:"出勤人数",type:"line",smooth:!0,itemStyle:{color:"#038eed"},areaStyle:{color:new this.$echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#038eed"},{offset:1,color:"#ffe"}])},data:this.chuqinY},{name:"抬头人数",type:"line",smooth:!0,data:this.taitouY,itemStyle:{color:"green"},areaStyle:{color:new this.$echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#67c23a"},{offset:1,color:"#ffe"}])}}]})},getList:function(){var i=this,t=void 0,e=void 0,n=void 0,s=void 0;i.img=[],i.chuqinY=[],i.xdata=[],i.taitouY=[];var a=!1;this.formInline.beginTimeH>this.formInline.endTimeH?(this.$message("不允许停止时间小于开始时间!"),a=!1):this.formInline.beginTimeH==this.formInline.endTimeH&&this.formInline.beginTimeS>=this.formInline.endTimeS?(this.$message("不允许停止时间小于等于开始时间!"),a=!1):a=!0,a&&(this.formInline.beginTimeH>=0&&(t=this.formInline.beginTimeH<10?"0"+this.formInline.beginTimeH:this.formInline.beginTimeH),this.formInline.beginTimeS>=0&&(e=this.formInline.beginTimeS<10?"0"+this.formInline.beginTimeS:this.formInline.beginTimeS),this.formInline.endTimeH>=0&&(n=this.formInline.endTimeH<10?"0"+this.formInline.endTimeH:this.formInline.endTimeH),this.formInline.endTimeS>=0&&(s=this.formInline.endTimeS<10?"0"+this.formInline.endTimeS:this.formInline.endTimeS),this.listQuery.beginTime=t+":"+e+":00",this.listQuery.endTime=n+":"+s+":59",this.listQuery.data=this.formInline.data,this.$http.get(this.host+"/GetAcademicPicture.do?date="+this.listQuery.data+"&startTime="+this.listQuery.beginTime+"&stopTime="+this.listQuery.endTime+"&rand="+(new Date).getTime()).then(function(t){if(t.body.list!=[])for(var e=0;e<t.body.list.length;e++){i.xdata.push(t.body.list[e].timeStamp),i.taitouY.push(t.body.list[e].riseStuCnt),i.chuqinY.push(t.body.list[e].allStuCnt),i.frontAllSeat=t.body.frontAllSeat;var n={};n.img=t.body.list[e].filePath,n.time=t.body.list[e].timeStamp,i.img.push(n)}console.log(i.img,i.chuqinY,i.xdata),i.drawLine()}).catch(function(i){console.log(i)}))},handleSearch:function(){var i=void 0,t=void 0,e=void 0,n=void 0;this.formInline.beginTimeH>=0&&(i=this.formInline.beginTimeH<10?"0"+this.formInline.beginTimeH:this.formInline.beginTimeH),this.formInline.beginTimeS>=0&&(t=this.formInline.beginTimeS<10?"0"+this.formInline.beginTimeS:this.formInline.beginTimeS),this.formInline.endTimeH>=0&&(e=this.formInline.endTimeH<10?"0"+this.formInline.endTimeH:this.formInline.endTimeH),this.formInline.endTimeS>=0&&(n=this.formInline.endTimeS<10?"0"+this.formInline.endTimeS:this.formInline.endTimeS),this.listQuery.beginTime=i+":"+t+":00",this.listQuery.endTime=e+":"+n+":59",this.listQuery.data=this.formInline.data,this.getList()},getNowTime:function(){var i=new Date,t=i.getFullYear(),e=i.getMonth(),n=i.getDate();e=(e+=1).toString().padStart(2,"0"),n=n.toString().padStart(2,"0");var s={};return s.defaultDate=t+"-"+e+"-"+n,s.h=i.getHours(),s.m=i.getMinutes(),this.$set(this.formInline,"data",s.defaultDate),this.$set(this.formInline,"endTimeH",s.h),this.$set(this.formInline,"endTimeS",s.m),0==s.h?this.$set(this.formInline,"beginTimeH","22"):1==s.h?this.$set(this.formInline,"beginTimeH","23"):2==s.h?this.$set(this.formInline,"beginTimeH","00"):this.$set(this.formInline,"beginTimeH",parseInt(s.h)-2),this.$set(this.formInline,"beginTimeS",s.m),s},lookVideoGo:function(i){window.open(i)},getAiData:function(i){var t=this,e=JSON.parse(s()(i));e.StartTime=e.StartTime.split(":")[0]-0,e.EndTime=e.EndTime.split(":")[0]-0,this.$https.get("/Camera_GetAIData.do",e).then(function(i){i.Data?t.renderHtml(i.Data):t.getJson(i)})},getJson:function(i){var t=this;if(""!=i.length){var e=window.location.hostname;this.$https.get(window.location.protocol+"//"+e+":8000/"+i.split("Camera/")[1]).then(function(i){var e=t.queryObj.startTime,n=t.queryObj.endTime,s=i.Data.filter(function(i){var t=i.SaveHour;return t>=e&&t<n});t.renderHtml(s)})}},renderHtml:function(i){var t=[],e=[],n=[];i.forEach(function(i){t.push(i.DateTime.split(" ")[1]),n.push(i.AllCount),e.push(i.RiseCount)}),this.listData=i,this.xdata=t,this.chuqinY=n,this.taitouY=e,this.drawLine()},queryHandle:function(i){this.queryObj.startTime=i.StartTime.substring(0,2),this.queryObj.endTime=i.EndTime.substring(0,2),this.getAiData(i)},detailClick:function(){this.dialogPic=!0}},components:{QueryHead:e("2nSH").a}},o={render:function(){var i=this,t=i.$createElement,e=i._self._c||t;return e("div",{ref:"middle",staticStyle:{width:"100%"}},[e("query-head",{attrs:{listprop:i.listprop},on:{queryHandle:i.queryHandle}}),i._v(" "),e("div",{staticStyle:{"line-height":"35px","text-align":"right","font-size":"14px",overflow:"hidden"}},[e("span",{staticStyle:{"padding-right":"20px"}},[i._v("\n      前后排比值：\n      "),e("span",[i._v(i._s(i.frontAllSeat))])])]),i._v(" "),e("el-row",{staticStyle:{"margin-top":"10px"}},[e("div",{style:{width:"1200px",height:"600px",margin:"0 auto"},attrs:{id:"myChart"}})]),i._v(" "),e("el-dialog",{attrs:{title:"查看图片",visible:i.dialogPic},on:{"update:visible":function(t){i.dialogPic=t}}},[e("img",{staticStyle:{margin:"0 auto",display:"block",width:"100%"},attrs:{src:i.detailImgPath,alt:""}})])],1)},staticRenderFns:[]};var r=e("VU/8")(a,o,!1,function(i){e("4tRP")},"data-v-1d35dbd3",null);t.default=r.exports}});